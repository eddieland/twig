schema: spec-driven

context: |
  Twig is a Git-first productivity tool written in Rust that manages branches, issues,
  and pull requests across one or many repositories. Core focus: stacked pull-request
  workflows with cascading rebases.

  Tech stack: Rust 1.91+ (nightly), Clap for CLI, git2 for Git ops, reqwest for HTTP,
  tokio for async, serde for serialization, rmcp for MCP server.

  Workspace crates: twig-cli (binary), twig-core (shared logic), twig-gh (GitHub API),
  twig-jira (Jira API), twig-mcp (MCP server), no-worries (panic handler),
  twig-test-utils (test fixtures), plugins/twig-flow, plugins/twig-prune.

  Conventions:
  - Commands defined in twig-cli/src/cli/, business logic in sibling modules
  - State: global registry at XDG_DATA_HOME/twig/registry.json, per-repo at .twig/state.json
  - Credentials via ~/.netrc
  - Output via twig_core::output helpers, diagnostics via tracing
  - Testing with nextest + insta snapshots
  - Clippy: no unwrap, no panic, no print_stdout/stderr, no dbg/todo/unimplemented

rules:
  specs:
    - Use WHEN/THEN/AND scenario format for testable requirements
    - Reference specific CLI commands and flags where applicable
    - Note which crate(s) implement each requirement
  tasks:
    - Break tasks into chunks of max 2 hours
    - Include verification steps (tests, lint, manual check)
